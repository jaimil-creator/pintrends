{% if error %}
<div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-xl">
    <div class="flex">
        <div class="flex-shrink-0">
            <i class="bi bi-exclamation-circle text-red-500"></i>
        </div>
        <div class="ml-3">
            <p class="text-sm text-red-700">{{ error }}</p>
        </div>
    </div>
</div>
{% else %}
<div class="bg-white rounded-2xl shadow-sm p-6 border border-gray-100 animate-fade-in-up">
    <!-- Fixed template tag display: using display_title instead of keyword|title -->
    <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-bold text-gray-900">Interest over time: <span class="text-pinterest-red">{{
                display_title }}</span></h3>
        <span class="px-3 py-1 bg-gray-100 rounded-full text-xs font-semibold text-gray-600">Last 12 Months</span>
    </div>

    <div class="relative h-[400px] w-full">
        <canvas id="predictionChart"></canvas>
    </div>

    <script>
        // Data passed from Django view
        var labels = {{ labels| safe }};
        var historyData = {{ history| safe }};
        var predictionData = {{ prediction| safe }};
        var upperBounds = {{ upper| safe }};
        var lowerBounds = {{ lower| safe }};
        var separationIndex = {{ separation_index }};

        // Call the global render function
        renderpredictionChart(labels, historyData, predictionData, upperBounds, lowerBounds, separationIndex);
    </script>
</div>
{% endif %}